[gd_scene load_steps=15 format=3 uid="uid://clcwdr5begw0g"]

[ext_resource type="PackedScene" uid="uid://cqhe3y3sj4vb3" path="res://_scenes/player.tscn" id="1_to1an"]
[ext_resource type="Script" path="res://_scripts/main.gd" id="1_x328l"]
[ext_resource type="Material" uid="uid://bb5cgdyl5gj2y" path="res://_shaders/grounds/ground_patterns_mat.tres" id="3_q3a4a"]
[ext_resource type="Script" path="res://_scripts/label_kills.gd" id="5_2dbct"]
[ext_resource type="PackedScene" uid="uid://deykio3jwy2vg" path="res://_scenes/enemy.tscn" id="5_qh010"]
[ext_resource type="PackedScene" uid="uid://vlhe276mkt0b" path="res://_scenes/wave_system.tscn" id="5_qxbqk"]
[ext_resource type="Script" path="res://_scripts/camera.gd" id="7_ymsw7"]
[ext_resource type="Script" path="res://_scripts/spawner2.gd" id="8_d0k6m"]
[ext_resource type="PackedScene" uid="uid://02l4fil5f7hb" path="res://_scenes/spawner.tscn" id="8_nhsbs"]
[ext_resource type="PackedScene" uid="uid://bwr26kclpyg6b" path="res://_scenes/buddy.tscn" id="9_wxq6t"]

[sub_resource type="NavigationMesh" id="NavigationMesh_ya65r"]
vertices = PackedVector3Array(-255.456, 0.602213, -255.472, -255.456, 0.602213, 255.028, 255.044, 0.602213, 255.028, 255.044, 0.602213, -255.472)
polygons = [PackedInt32Array(3, 2, 0), PackedInt32Array(0, 2, 1)]
geometry_source_geometry_mode = 1
agent_height = 3.0
agent_radius = 0.75
agent_max_slope = 15.0
filter_walkable_low_height_spans = true

[sub_resource type="PlaneMesh" id="PlaneMesh_kgwl2"]
lightmap_size_hint = Vector2i(2562, 2562)
uv2_padding = 1.0
size = Vector2(512, 512)

[sub_resource type="PhysicsMaterial" id="PhysicsMaterial_0mh81"]
friction = 0.0
bounce = 6.16
absorbent = true

[sub_resource type="BoxShape3D" id="BoxShape3D_seigk"]
size = Vector3(512, 8, 512)

[node name="Main" type="Node3D"]
script = ExtResource("1_x328l")
kills_required_for_spread = 5
enemy_scene = ExtResource("5_qh010")

[node name="EnemyContainer" type="Node3D" parent="."]
transform = Transform3D(0.999919, 0, 0, 0, 0.999919, 0, 0, 0, 0.999919, 0, 0.53, 0)

[node name="NavigationRegion3D" type="NavigationRegion3D" parent="."]
navigation_mesh = SubResource("NavigationMesh_ya65r")

[node name="Floor" type="MeshInstance3D" parent="NavigationRegion3D" groups=["navigation_mesh_source_group"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.206244, 0.102213, -0.222153)
material_override = ExtResource("3_q3a4a")
gi_mode = 0
instance_shader_parameters/border_gradient = 0.535
instance_shader_parameters/border_size = 0.34
instance_shader_parameters/grid_color_border = Color(0.108902, 0.238281, 0.144279, 1)
instance_shader_parameters/grid_color_fill = Color(0.383705, 0.57, 0.3591, 1)
instance_shader_parameters/grid_scale = 200.0
instance_shader_parameters/randomness = 0.54
mesh = SubResource("PlaneMesh_kgwl2")
skeleton = NodePath("")

[node name="MeshInstance3D" type="StaticBody3D" parent="NavigationRegion3D/Floor" groups=["navigation_mesh_source_group"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.206244, -0.102213, 0.222153)
physics_material_override = SubResource("PhysicsMaterial_0mh81")

[node name="CollisionPolygon3D" type="CollisionShape3D" parent="NavigationRegion3D/Floor/MeshInstance3D" groups=["navigation_mesh_source_group"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -4.5, 0)
shape = SubResource("BoxShape3D_seigk")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 0.449397, 0.893332, 0, -0.893332, 0.449397, 10, 15, 14)
light_bake_mode = 0
shadow_enabled = true
shadow_opacity = 0.69
shadow_blur = 0.17
directional_shadow_mode = 1
directional_shadow_split_1 = 0.31
directional_shadow_fade_start = 1.0
directional_shadow_max_distance = 80.0
sky_mode = 1

[node name="LabelKills" type="Label" parent="."]
layout_direction = 1
anchors_preset = 1
anchor_left = 1.0
anchor_right = 1.0
offset_left = -83.32
offset_top = 23.0
offset_right = -19.32
offset_bottom = 57.0
grow_horizontal = 0
scale = Vector2(2, 2)
pivot_offset = Vector2(68.11, 0)
text = "00"
horizontal_alignment = 2
text_direction = 1
script = ExtResource("5_2dbct")

[node name="GameCamera" type="Camera3D" parent="." node_paths=PackedStringArray("player_pos")]
transform = Transform3D(0.707107, 0, 0.707107, 0, 1, 0, -0.707107, 0, 0.707107, 24, 46, 24)
fov = 24.0
script = ExtResource("7_ymsw7")
player_pos = NodePath("../Player")
camera_offset = Vector3(30, 54, 24)
max_offset = 3.0
recovery_speed = 2.0
damping = 0.6

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="."]
path_max_distance = 0.01

[node name="WaveSystem" parent="." instance=ExtResource("5_qxbqk")]

[node name="Spawner" parent="." node_paths=PackedStringArray("player") groups=["enemies"] instance=ExtResource("8_nhsbs")]
script = ExtResource("8_d0k6m")
player = NodePath("../Player")
spawn_scene = ExtResource("5_qh010")
min_radius = 16.0
max_radius = 20.0
spawn_count = 5
respawn_time = 12.0
pursuit_speed = 5.0

[node name="Buddy" parent="." instance=ExtResource("9_wxq6t")]
collision_layer = 0
collision_mask = 0
input_ray_pickable = false
slide_on_ceiling = false
floor_stop_on_slope = false
floor_block_on_wall = false
offset_to_player = Vector3(0, 8, 1)
noise_time_scale = 9.365

[node name="Player" parent="." instance=ExtResource("1_to1an")]
